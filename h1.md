
# a) Linux. Asenna Debian tai Kali Linux virtuaalikoneeseen. (Tätä alakohtaa ei poikkeuksellisesti tarvitse raportoida, jos sinulla ei ole mitään ongelmia. Jos on mitään haasteita, tee täsmällinen raportti)


Kali Linux asennettu virtualboxiin.

# b) Ei voi kalastaa. Osoita, että pystyt katkaisemaan ja palauttamaan virtuaalikoneen Internet-yhteyden.



Tässä käytin ping komentoa palvelimelle. 

<img width="557" height="157" alt="image" src="https://github.com/user-attachments/assets/221bd099-10ee-4cb1-85cb-15499880e189" />

8.8.8.8 pingi ei tuottanut tulosta, voidaan totea että nettiyhteys on pois päältä. 


# c) Wireshark. Asenna Wireshark. Sieppaa liikennettä Wiresharkilla. (Vain omaa liikennettäsi. Voit käyttää tähän esimerkiksi virtuaalikonetta).

Wiresharkki oli jo olemassa kali Linuxisssa, siinä käynnistin wiresharkin ja capturasin "any" paketteja.

any = yrittää capturaa kaikkeja paketteja liikenteessä

Avasin firefox selaimen kalissa, kyseinen paketti tallentui wiresharkkiin.

<img width="1744" height="134" alt="image" src="https://github.com/user-attachments/assets/8c382fe9-37d1-413f-8317-c953f29603e0" />


# d) Oikeesti TCP/IP. Osoita TCP/IP-mallin neljä kerrosta yhdestä siepatusta paketista. Voit selityksen tueksi laatikoida ne ruutukaappauksesta. [  Lähde 2) ](https://en.wikipedia.org/wiki/Internet_protocol_suite) ,[Lähde 3)](https://wiki.wireshark.org/PortReference) 

Valitsin saman paketin mikä oli aikasemmassa näytönkaappauksessa. Tässä on kyse loopback paketista. Sen tietää siitä kun source ja destination ip ovat samoja. 

<img width="964" height="324" alt="image" src="https://github.com/user-attachments/assets/1f49a97a-6e44-4187-ad01-771ffeb89e4e" />

Tämän perusteella haluaisin sanoa, application layerin protocolla on DNS, mutta kun avaa kehyksen, siinä lukee protocolla UDP.

Selvittelyn jälkeen sain tietää mistä tämä johtuu, tästä artikkelistä https://www.wireshark.org/docs/wsug_html_chunked/ChUsePacketListPaneSection.html

Erovaisuus johtuu siitä, että DNS on ylimmän tason paketti, joten ainoastaan se näkyy packet list rowissa, eli DNS on application layerin protocollan paketti.

Siitä alempana on UDP, mikä kuuluu transport layeriin. Portti: 17. 

<img width="954" height="305" alt="image" src="https://github.com/user-attachments/assets/cd5db839-65dc-4fb8-8ce9-12af432522a5" />

Siitä alempana on internet layeri, tässä tapauksessa on kysee ipv4. 

Sen voi päättää otsikosta mikä on ympäröity punaisella näytönkaappauksessa.

<img width="721" height="205" alt="image" src="https://github.com/user-attachments/assets/c07cfe76-8385-4fa1-953f-8306118acf38" />

Siitä alimpana on Link layer. Tässä vaiheessa meinasin sekoa kun en löytänyt millään alimman tason layeria kehyksestä. Päätin avata uuden paketin ja katsoa siitä, löytyykö alimman tason paketti sieltä.

<img width="1467" height="62" alt="image" src="https://github.com/user-attachments/assets/3ef56b1f-0df3-4b43-a7db-8c8625758496" />

Uudessa paketissa näkyy selvästi, että kyseessä on ARP mikä kuuluu alimman tason kerrokselle. 

<img width="905" height="259" alt="image" src="https://github.com/user-attachments/assets/cf515036-60c2-4ce8-b79c-c2ff632022b9" />


# e) Mitäs tuli surffattua? Avaa surfing-secure.pcap. Tutustu siihen pintapuolisesti ja kuvaile, millainen kaappaus on kyseessä. Tässä siis vain lyhyesti ja yleisellä tasolla. Voit esimerkiksi vilkaista, montako konetta näkyy, mitä protokollia pistää silmään. Määrästä voit arvioida esimerkiksi pakettien lukumäärää, kaappauksen kokoa ja kestoa. [Lähde 6](https://wiki.wireshark.org/TLS#tls-decryption) [Lähde 5](https://en.wikipedia.org/wiki/QUIC) 

QUIC protokolla en ole aikasemmin nähnyt, mutta ilmeisesti tämä on googlen oma kehittämä protokolla mitä nykyään käyttää kaikki selaimet.

Ilmeisesti kirjauduttu terokarvinen.com admin paneelille tai otettu yhteys siihen, TLS handshakesta päätellen. 

Muutama arp requesti oman subnetin sisällä, ehkä tässä otettiin yhteyttä johonki omassa lähi verkossa pyörivään serveriin

<img width="1543" height="46" alt="image" src="https://github.com/user-attachments/assets/f946244a-9b31-4d8c-a6a7-2c7d5736a522" />


Lopulta yhteys päättyi 

<img width="1080" height="61" alt="image" src="https://github.com/user-attachments/assets/6c4bac97-0603-47d1-a62b-b880b8520f2e" />



# f) Vapaaehtoinen, vaikea: Mitä selainta käyttäjä käyttää? surfing-secure.pcap (Päivitys 2025-03-31 w14 ma - muutin tehtävän vapaaehtoiseksi Giang:n suosituksesta)

Yleensä tämän pystyy päättämään user-agentista, mutta kun ei ole http protokollaa käytetty niin user agentti on myöskin salattu. 

Tässä vaiheessa pyysin hieman apua muilta kurssilaisilta, kurssilainen Ilja antoi vinkiksi että katso TLS:ssää.

Avasin wiresharkissa TLS:ssän ja sieltä alkoi ilmestyä mielenkiintoisia asioita

Tässä oli kaikkea mielenkiintoista, esim session ID ja Cipher suites.

Lähin tutkimaan session ID:tä, mitä sen avulla voi tehdä. 

Selvitin mitä sillä voi tehdä, esim session ID:llä voi jatkaa yhteyttä palvelimen välillä, mutta kun en tiedä mikä palvelin on kyseessä niin en lähtenyt tutkimaan tätä lisää.

Kelasin tässä vähän enemmän kunnes löysin JA4 ja JA3 hasheja.

Tämä kopioitu suoraan googlesta: "A JA4 fingerprint is a unique identifier for a client's SSL/TLS configuration, created by analyzing the "Client Hello" message during the handshake of a secure connection. This fingerprint helps security analysts and systems identify specific clients, such as browsers or malware, and can be used for purposes like bot mitigation, DDoS attack prevention, and threat intelligence." Tässä lisätietoa (https://blog.cloudflare.com/ja4-signals/)

Tämän perusteella sain tietää, että tämä on todennäköisesti julkinen identifoija millä voidaan tunnistaa yhteys. 

Joten, luin lisää netistä mitä tällä JA4 voi oikee tehdä. Törmäsin tähän artikkeliin netissä: (https://blog.virustotal.com/2024/10/unveiling-hidden-connections-ja4-client.html)

Tässä virustotal käyttä omaa tietokantaa JA4 fingerprinttejä varten, tässä kun syötin oman fingerprintin ei tullut mitään tulosta. 

<img width="1497" height="544" alt="image" src="https://github.com/user-attachments/assets/318f9d38-707e-49b4-8e4b-094407b2683a" />

Joten päätin hakea jonkun julkisen JA4 tietokannan missä pystyn etsimään kyseistä fingerprinttiä.

Päädyin tähän sivustoon: https://ja4db.com/

Latasin tietokannan ja etsin kyseisen fingerprintin sieltä

<img width="822" height="137" alt="image" src="https://github.com/user-attachments/assets/9e147c25-4157-4ff9-8c6f-8b2701115532" />

Vastaus tähän tehtävään on siis gecko / firefox (?)

# g) Minkä merkkinen verkkokortti käyttäjällä on? surfing-secure.pcap

Koitin monia mac osoite lookuppeja, mutta en löytänyt mitään. Esim. https://macvendors.com/

Kuitenkin tajusin, että tero ei todennäköisesti käyttänyt fyysistä konetta tätä tehtäessaa, vaan jotain virtuaali ympäristöä.

Kun googlasin mac osoitteen etuosa, löysin seuraavan: https://devonhubner.org/KVM_MAC_Address_Generator/

Tämä on virtuaalisesti generoitu mac osoite, joten vendori on joku virtuaalialusta mikä on generoinut kyseisen mac osoitteen. 


# h) Millä weppipalvelimella käyttäjä on surffaillut? surfing-secure.pcap

Terokarvinen.com:illa on vierailtu, goatcounter on kytketty terokarvisen sivuille mikä on open source weppipalvelimen tilastoja varten, sinne ilmeisesti lähetetty pyyntöjä, minkä takii ne näkyvät tässä.

Google.com illa on vierailtu.

# i) Analyysi. Sieppaa pieni määrä omaa liikennettäsi. Analysoi se, eli selitä mahdollisimman perusteellisesti, mitä tapahtuu. (Tässä pääpaino on siis analyysillä ja selityksellä, joten liikennettä kannattaa ottaa tarkasteluun todella vähän - vaikka vain pari pakettia. Gurut huomio: Selitä myös mielestäsi yksinkertaiset asiat.)

Tässä päätin analysoida 4 pakettia.

<img width="1523" height="75" alt="image" src="https://github.com/user-attachments/assets/16ac94a1-e36d-4f02-9b89-688467dcd016" />

Tässä on 4 pakettia. Aloitetaan pe




Lähteet: 

1) https://terokarvinen.com/verkkoon-tunkeutuminen-ja-tiedustelu/
2) https://en.wikipedia.org/wiki/Internet_protocol_suite
3) https://wiki.wireshark.org/PortReference
4) https://www.wireshark.org/docs/wsug_html_chunked/ChUsePacketListPaneSection.html
5) https://en.wikipedia.org/wiki/QUIC
6) https://wiki.wireshark.org/TLS#tls-decryption
