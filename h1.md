Lokaatio: Helsinki

Ympäristö: Kali Linux Virtualboxsissa ja Windows 11 host OS:ssä tehty tehtävä f

Päivämäärä: 24/10/2025 18:00-21:20, Päivitys: 24/10/2025  21:30-22:30




# a) Linux. Asenna Debian tai Kali Linux virtuaalikoneeseen. (Tätä alakohtaa ei poikkeuksellisesti tarvitse raportoida, jos sinulla ei ole mitään ongelmia. Jos on mitään haasteita, tee täsmällinen raportti)


Kali Linux asennettu virtualboxiin.

# b) Ei voi kalastaa. Osoita, että pystyt katkaisemaan ja palauttamaan virtuaalikoneen Internet-yhteyden.



Tässä käytin ping komentoa palvelimelle. 

<img width="557" height="157" alt="image" src="https://github.com/user-attachments/assets/221bd099-10ee-4cb1-85cb-15499880e189" />

8.8.8.8 pingi ei tuottanut tulosta, voidaan totea että nettiyhteys on pois päältä. 


# c) Wireshark. Asenna Wireshark. Sieppaa liikennettä Wiresharkilla. (Vain omaa liikennettäsi. Voit käyttää tähän esimerkiksi virtuaalikonetta).

Wiresharkki oli jo olemassa kali Linuxisssa, siinä käynnistin wiresharkin ja capturasin "any" paketteja.

any = yrittää capturaa kaikkeja paketteja liikenteessä

Avasin firefox selaimen kalissa, kyseinen paketti tallentui wiresharkkiin.

<img width="1744" height="134" alt="image" src="https://github.com/user-attachments/assets/8c382fe9-37d1-413f-8317-c953f29603e0" />


# d) Oikeesti TCP/IP. Osoita TCP/IP-mallin neljä kerrosta yhdestä siepatusta paketista. Voit selityksen tueksi laatikoida ne ruutukaappauksesta. [  Lähde 2) ](https://en.wikipedia.org/wiki/Internet_protocol_suite) ,[Lähde 3)](https://wiki.wireshark.org/PortReference) 

Valitsin saman paketin mikä oli aikasemmassa näytönkaappauksessa. Tässä on kyse loopback paketista. Sen tietää siitä kun source ja destination ip ovat samoja. 

<img width="964" height="324" alt="image" src="https://github.com/user-attachments/assets/1f49a97a-6e44-4187-ad01-771ffeb89e4e" />

Tämän perusteella haluaisin sanoa, application layerin protocolla on DNS, mutta kun avaa kehyksen, siinä lukee protocolla UDP.

Selvittelyn jälkeen sain tietää mistä tämä johtuu, tästä artikkelistä https://www.wireshark.org/docs/wsug_html_chunked/ChUsePacketListPaneSection.html

Erovaisuus johtuu siitä, että DNS on ylimmän tason paketti, joten ainoastaan se näkyy packet list rowissa, eli DNS on application layerin protocollan paketti.

Siitä alempana on UDP, mikä kuuluu transport layeriin. Portti: 17. 

<img width="954" height="305" alt="image" src="https://github.com/user-attachments/assets/cd5db839-65dc-4fb8-8ce9-12af432522a5" />

Siitä alempana on internet layeri, tässä tapauksessa on kysee ipv4. 

Sen voi päättää otsikosta mikä on ympäröity punaisella näytönkaappauksessa.

<img width="721" height="205" alt="image" src="https://github.com/user-attachments/assets/c07cfe76-8385-4fa1-953f-8306118acf38" />

Siitä alimpana on Link layer. Tässä vaiheessa meinasin sekoa kun en löytänyt millään alimman tason layeria kehyksestä. Päätin avata uuden paketin ja katsoa siitä, löytyykö alimman tason paketti sieltä.

<img width="1467" height="62" alt="image" src="https://github.com/user-attachments/assets/3ef56b1f-0df3-4b43-a7db-8c8625758496" />

Uudessa paketissa näkyy selvästi, että kyseessä on ARP mikä kuuluu alimman tason kerrokselle. 

<img width="905" height="259" alt="image" src="https://github.com/user-attachments/assets/cf515036-60c2-4ce8-b79c-c2ff632022b9" />


# e) Mitäs tuli surffattua? Avaa surfing-secure.pcap. Tutustu siihen pintapuolisesti ja kuvaile, millainen kaappaus on kyseessä. Tässä siis vain lyhyesti ja yleisellä tasolla. Voit esimerkiksi vilkaista, montako konetta näkyy, mitä protokollia pistää silmään. Määrästä voit arvioida esimerkiksi pakettien lukumäärää, kaappauksen kokoa ja kestoa. [Lähde 6](https://wiki.wireshark.org/TLS#tls-decryption) [Lähde 5](https://en.wikipedia.org/wiki/QUIC) 

QUIC protokolla en ole aikasemmin nähnyt, mutta ilmeisesti tämä on googlen oma kehittämä protokolla mitä nykyään käyttää kaikki selaimet.

Ilmeisesti kirjauduttu terokarvinen.com admin paneelille tai otettu yhteys siihen, TLS handshakesta päätellen. 

Muutama arp requesti oman subnetin sisällä, ehkä tässä otettiin yhteyttä johonki omassa lähi verkossa pyörivään serveriin.

<img width="1543" height="46" alt="image" src="https://github.com/user-attachments/assets/f946244a-9b31-4d8c-a6a7-2c7d5736a522" />

Paketteja oli yhteensä 283.

Kaappaus kesti yhteensä 7 sekunttia.

Lopulta yhteys päättyi. 

<img width="1080" height="61" alt="image" src="https://github.com/user-attachments/assets/6c4bac97-0603-47d1-a62b-b880b8520f2e" />



# f) Vapaaehtoinen, vaikea: Mitä selainta käyttäjä käyttää? surfing-secure.pcap (Päivitys 2025-03-31 w14 ma - muutin tehtävän vapaaehtoiseksi Giang:n suosituksesta)

Yleensä tämän pystyy päättämään user-agentista, mutta kun ei ole http protokollaa näkyvissä niin user agentti on myöskin salattu. 

Tässä vaiheessa pyysin hieman apua muilta kurssilaisilta, kurssilainen Ilja antoi vinkiksi että katso TLS:ssää.

Avasin wiresharkissa ensimmäisen TLS handshaken ("Client Hello") ja sieltä alkoi ilmestyä mielenkiintoisia asioita.

<img width="1793" height="138" alt="image" src="https://github.com/user-attachments/assets/f8bfe6ec-3d6a-422d-80d1-3e51bd33dc79" />

Tässä oli kaikkea mielenkiintoista, esim session ID ja Cipher suites.

Lähin tutkimaan session ID:tä, mitä sen avulla voi tehdä. 

Selvitin mitä sillä voi tehdä, esim session ID:llä voi jatkaa yhteyttä palvelimen välillä, mutta kun en tiedä mikä palvelin on kyseessä niin en lähtenyt tutkimaan tätä lisää.

Cipher suites, mielestäni tällä tiedolla en olisi voinut tehdä mitään, sillä siinä on vain luettelo eri algorytmeissä mitä käytettiin kun TLS yhteys muodostettiin.

Tutkin framea, enemmän kunnes löysin JA4 ja JA3 hasheja.

Tämä kopioitu suoraan googlesta: "A JA4 fingerprint is a unique identifier for a client's SSL/TLS configuration, created by analyzing the "Client Hello" message during the handshake of a secure connection. This fingerprint helps security analysts and systems identify specific clients, such as browsers or malware, and can be used for purposes like bot mitigation, DDoS attack prevention, and threat intelligence." Tässä lisätietoa (https://blog.cloudflare.com/ja4-signals/) & (https://strangebee.com/blog/ja4-fingerprinting-now-available-in-thehive/)

Tämän perusteella sain tietää, että tämä on todennäköisesti julkinen identifoija millä voidaan tunnistaa yhteys. 

Joten, luin lisää netistä mitä tällä JA4 voi oikee tehdä. Törmäsin tähän artikkeliin netissä: (https://blog.virustotal.com/2024/10/unveiling-hidden-connections-ja4-client.html)

Tässä virustotal käyttä omaa tietokantaa JA4 fingerprinttejä varten, tässä kun syötin oman fingerprintin ei tullut mitään tulosta. 

<img width="1497" height="544" alt="image" src="https://github.com/user-attachments/assets/318f9d38-707e-49b4-8e4b-094407b2683a" />

Joten päätin hakea jonkun julkisen JA4 tietokannan missä pystyn etsimään kyseistä fingerprinttiä.

Päädyin tähän sivustoon: https://ja4db.com/

Latasin tietokannan ja etsin kyseisen fingerprintin sieltä

<img width="822" height="137" alt="image" src="https://github.com/user-attachments/assets/9e147c25-4157-4ff9-8c6f-8b2701115532" />

Vastaus tähän tehtävään on siis gecko / firefox (?)

# g) Minkä merkkinen verkkokortti käyttäjällä on? surfing-secure.pcap

Koitin monia mac osoite lookuppeja, mutta en löytänyt mitään. Esim. https://macvendors.com/

Todennäköisesti Tero ei käyttänyt fyysistä konetta tätä tehtäessään, vaan jotain virtuaali ympäristöä, joten googlasin enemmän mac osoitetta.

Kun googlasin mac osoitteen etuosan, löysin seuraavan: https://devonhubner.org/KVM_MAC_Address_Generator/

Tämä on virtuaalisesti generoitu mac osoite, joten vendori on joku virtuaalialusta mikä on generoinut kyseisen mac osoitteen. 


# h) Millä weppipalvelimella käyttäjä on surffaillut? surfing-secure.pcap

Terokarvinen.com:illa on vierailtu, goatcounter on kytketty terokarvisen sivuille mikä on open source weppipalvelimen tilastoja varten, sinne ilmeisesti lähetetty pyyntöjä, minkä takii ne näkyvät tässä.

Google.com illa on vierailtu.

--Päivitys 24.10.2025 klo 21:30-- //(kun olin arvioimassa muitten tehtäviä tajusin että tämä osuus puuttui kokonaan)

# i) Analyysi. Sieppaa pieni määrä omaa liikennettäsi. Analysoi se, eli selitä mahdollisimman perusteellisesti, mitä tapahtuu. (Tässä pääpaino on siis analyysillä ja selityksellä, joten liikennettä kannattaa ottaa tarkasteluun todella vähän - vaikka vain pari pakettia. Gurut huomio: Selitä myös mielestäsi yksinkertaiset asiat.)

Tässä päätin analysoida 4 pakettia.

<img width="1523" height="75" alt="image" src="https://github.com/user-attachments/assets/16ac94a1-e36d-4f02-9b89-688467dcd016" />

Mielenkiintoista on tässä se, että ensimmäiset 2 riviä lähettävät samaan ip osoitteeseen keep alive pyynnön, mutta hieman eri infolla. 

TCP Keep-Alive = Tämän tarkoitus on tarkistaa, onko yhteys vielä olemassa ja pitääkö yhteyttä ylläpitää. TCP yhteydellä on oma ajastin, tietyinä intervaaleina se lähettää tämän keep alive pyynnön kun ajastin on tullut täyteen.

Jos tälläistä keep-alive pyyntöä ei olisi olemassa, TCP yhteys voisi olla teoreettisesti ikuisesti auki.

Tässä kuitenkin on huomioitava se, että se lähetti 2 kehystä. Tästä päädyin kysyä neuvoa tekoälyltä.

Tekoäly oli sitä mieltä, että koska mulla oli kaksi instanssia (esim. kaksi välilehteä) auki, siitä syystä kaksi tcp keep alive pyyntöä samalle ip osoitteelle.

ACK-lippu tarkoittaa, että vastaanottajan pitää käsitellä ACK-numerokenttä. Tässä tapauksessa ACK=9923 tarkoittaa, että lähettäjä on vastaanottanut kaikki tavut 8922:een asti, ja odottaa seuraavaksi tavua 9923.

Seq tarkoittaa että tämän paketin data alkaa tästä tavunumerosta. 

Win tarkoittaa paljon tilaa vastaanottaa tavuja.

Len tarkoittaa monta tavua dataa on paketissa. 

portti 50066, tarkoittaa source porttia ja 80 destination porttia. 

<img width="1462" height="20" alt="image" src="https://github.com/user-attachments/assets/cab1040c-493d-4e3d-9704-7ff94de288f8" />

TCP Keep-Alive ACK on taas vastaus aiempaan pyyntöön, missä TCP yhteys halutaan pitää auki. Tässä huomaat kans missä nyt Keep-alive ACK:illa on SEQ=9923 mikä oli aikasemmassa paketissa ACK kentän arvo.


Lähteet: 

1) https://terokarvinen.com/verkkoon-tunkeutuminen-ja-tiedustelu/
2) https://en.wikipedia.org/wiki/Internet_protocol_suite
3) https://wiki.wireshark.org/PortReference
4) https://www.wireshark.org/docs/wsug_html_chunked/ChUsePacketListPaneSection.html
5) https://en.wikipedia.org/wiki/QUIC
6) https://wiki.wireshark.org/TLS#tls-decryption
