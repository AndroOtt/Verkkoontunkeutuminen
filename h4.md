  # a) Tarkastele käytössäsi olevia RFID tuotteita, mieti miten hyvin olet suojautunut RFID urkinnalta?

Minulla on käytössä maksukortti, iphonin apple pay ja apple watch.

[Lähde 1](https://en.wikipedia.org/wiki/RFID_skimming)

RFID-skimmaus on hyökkäys, jossa rikollinen käyttää laitetta, joka jäljittelee maksupäätettä. Kun laite tuodaan lähelle uhrin maksukorttia, se lukee kortilta perustiedot kuten korttinumeron ja vanhenemispäivän. 

Näitä tietoja voidaan myöhemmin käyttää verkkomaksuihin sivustoilla.

RFID-skannerit eivät voi lukea korttitietoja useiden metrien päästä. 

Käytännössä hyökkääjän on oltava muutaman senttimetrin etäisyydellä kortista, vaihtoehtoisesti näitä skimmereitä voi asentaa pankkiautomaatteihin missä sinulla on 100% varmuus saada kortin tiedot talteen.

Fyysisen maksukortin lukeminen ei myöskään paljasta kaikkia tietoja. Kortin siru ei luovuta CVV-koodia eikä PIN-koodia, ja jokainen transaktio vaatii kryptogrammin, joten kortin tietoja ei voida käyttä maksupäätteellä.

Apple pay (iphonelle ja apple watchille) on silloin turvallisempi, koska maksu aktivoituu vaan kun käyttäjä itse halua laittaa nfc siru maksun päälle (face id).

Tietääkseni apple pay ei koskaan jaa oikeaa korttinumeroa vaan käyttää tokenisoitua numeroa transaktion tekemiseen. 

[Lähde 2](https://en.wikipedia.org/wiki/Relay_attack)

Auton avaimiin voi kohdistaa relay hyökkäyksen, missä varas käyttää kahta laitetta: toinen poimii signaalin avaimestasi, vaikka se olisi talosi sisällä, ja toinen huijaa autosi luulemaan, että avain on lähellä.

Keyless entry -auton avaimen signaali kaapataan laitteella ulkopuolelta uhrin talosta. 

- Vaihe 1 – Laite lähettää signaalin toiselle henkilölle, joka seisoo uhrin auton vieressä. 
- Vaihe 2 – Tämä huijaa auton luulemaan, että avain on sen lähellä, jolloin ovet avautuvat ja moottorin voi käynnistää.

Tälläiseltä hyökkäyseltä voisin suojautua laittamalla auton avaimet folioon yön yli.

[Lähde 3](https://en.wikipedia.org/wiki/Replay_attack)

Myös auton avaimiin voi kohdistaa replay hyökkäyksen, mikä toimii tallentamalla ja estämällä radiosignaalin avaimesta. 

Koska signaali estettiin, auto ei avaudu ja omistaja yrittää uudelleen, koska luulee että laite ei toimi tai ei ottanut syystä X signaalia. 

Auton omistaja tuottaa toisen signaalin, joka myös tallennetaan ja estetään, mutta tällä kertaa hyökkääjä ottaa koodin talteen.

Omistaja ei huomaa mitään, mutta nyt hyökkääjä tietää seuraavan koodin sekvenssissä, jota ei ole vielä mitätöity ja voi käyttää sitä avatakseen auton myöhemmin.

Periatteessa en pysty suojautumaan tälläiseltä hyökkäykseltä.

  # b) Tutustu APDU komentojen rakenteeseen (voit käyttää tekoälyä tutustumiseen)
  
- APDU (Application Protocol Data Unit)

Ymmärtääkseni tämä kommunikaatio tapahtuu kun laitat pankkikortin maksupäätteeseen tai luet henkilökorttia, laite ja kortti keskustelevat APDU-viesteillä.
  
Kortti kommunikoi heksaluvuissa, esim 00 A4 04 00, se oikeesti tarkoittaa CLA INS P1 P2.

- CLA = Komennon tyyppi "standardikomento"
- INS = Itse komento "Select"
- P1 = Lisätiedot miten valinta tehdään
- P2 = lisätarkenne

Kortti vastaa tähän vähintään kahdella tavulla: esim. 90 00 m,ikä tarkoittaa "onnistui"

Eli APDU toimi näissä tilanteissa vain välittäjänä, mikä vaan ottaa vastaan dataa ja välittää sitä.
  
  # c) Tutki ja kerro minkä mielenkiintoisen RFID hakkerointi uutiset löysit. (Vinkki, useimmat liittyvät henkilökortteihin)

Tämä uutinen oli mielenkiintoinen: (varmaan johtuen siitä että olen virolainen), mutta virossa oli vakava ROCA vulnerability [Lähde 4](https://www.ria.ee/sites/default/files/documents/2022-11/Roca-vulnerability-and-eID-lessons-learned-2018.pdf)

ROCA = Return of the Coppersmith Attack, se hyödyntää vikaa RSA-avaintent generoinnissa.

Raportoitiin, että Infineonin kehittämässä koodikirjastossa, jota käytettiin älykorteissa ja TPM-moduuleissa, oli vika (myöhemmin nimeltään ROCA-haavoittuvuus)

joka mahdollisti yksityisten avainten päättelemisen julkisista avaimista.

RSA toimii suurinpiirtein näin:

- Valitaan kaksi satunnaista alkulukua: p ja q (alkuluvut ovat siis massiivisa)
- Lasketaan n = p < q (julkinen avain sisältää n:n)
- Yksityinen avain perustuu p:hen ja q:hun

n:n tekijöihin jakaminen on laskennallisesti mahdotonta

jos p ja q ovat aidosti satunnaisia

Infineonin kirjasto EI generoinut aidosti satunnaisia alkulukuja. Sen sijaan se käytti "nopeampaa" menetelmää, joka tuotti alkulukuja tietyllä matemaattisella rakenteella.

Infineonin p ja q noudattivat kaavaa:

p = k × M + (65537^a mod M)

Missä M on tiettyjen pienten alkulukujen tulo

Käytännössä jos rakennat algorytmin tämän laskukaavan mukaisesti pystyt laskemaan alkuperäiset alkuluvut.

Viron kortit käyttivät 2048-bittisiä avaimia, joten hyökkäys oli laskennallisesti raskas ja kallista mutta teoreettisesti mahdollista. 

Viron sähköisen identiteetin järjestelmässä se teki teoreettisesti mahdolliseksi esiintyä käyttäjänä ja allekirjoittaa tai purkaa dokumentteja. 

Lähteet: 

Tehtävänanto: Moodle, Verkkoon tunkeutuminen. Larin osio.

https://terokarvinen.com/verkkoon-tunkeutuminen-ja-tiedustelu/#laksyt
  
